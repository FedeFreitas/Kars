"use client";
import Image from "next/image";
import { useState } from "react";
import { createLead } from "@/services/leads";
import { useToast } from "@/components/ToastProvider";

export default function Home() {
  const toast = useToast();
  const [loading, setLoading] = useState(false);
  const [ok, setOk] = useState(false);
  const [showConfirm, setShowConfirm] = useState(false);
  const [form, setForm] = useState({
    name: "",
    cpf: "",
    birthdate: "",
    phone: "",
    email: "",
    city: "",
    ear: "Nao",
    uber: "Nao",
  });

  function set(field, value) {
    setForm((f) => ({ ...f, [field]: value }));
  }

  async function submit(e) {
    e.preventDefault();
    if (loading) return;
    setOk(false);
    setShowConfirm(true);
  }

  async function confirmSubmit() {
    if (loading) return;
    setLoading(true);
    try {
      await createLead(form);
      setOk(true);
      setShowConfirm(false);
    } catch (e) {
      const msg = e?.message || "Erro ao enviar cadastro";
      toast.error(msg);
    } finally {
      setLoading(false);
    }
  }

  return (
    <main className="w-full min-h-screen bg-neutral-50 text-neutral-900">
      {/* NAVBAR */}
      <header className="w-full bg-neutral-900 text-white py-3 shadow-lg fixed top-0 left-0 z-50">
        <div className="max-w-6xl mx-auto px-4 md:px-6 flex items-center justify-between">
          {/* LOGO */}
          <div className="flex items-center gap-3">
            <Image src="/Kars-logo.png" width={44} height={44} alt="Logo" />
            <span className="text-lg md:text-xl font-bold text-yellow-400">Kars</span>
          </div>
          {/* LINKS DESKTOP */}
          <nav className="hidden md:flex gap-8 text-sm font-medium">
            <a href="#como-funciona" className="hover:text-yellow-400  py-2  transition">Como funciona</a>
            <a href="#por-que" className="hover:text-yellow-400  py-2 transition">Por que a Kars</a>
            <a href="#parceiros" className="hover:text-yellow-400 py-2  transition">Contato</a>
            {/* Botão Login - Desktop */}
            <a
              href="/login"
              className="px-5 py-2 bg-yellow-400 hover:bg-yellow-500 text-black rounded-full font-semibold shadow transition cursor-pointer"
            >
              Login
            </a>
          </nav>
          {/* BOTÃO LOGIN MOBILE */}
          <a
            href="/login"
            className="
        md:hidden 
        px-4 py-2 
        bg-yellow-400 
        text-black 
        rounded-full 
        shadow 
        font-semibold 
        text-sm
        hover:bg-yellow-500 
        transition 
        cursor-pointer
      "
          >
            Login
          </a>
        </div>
      </header>
      {/* HERO */}
      <section className="w-full px-4 md:px-6 pt-28 md:pt-32 pb-20 md:pb-28 bg-yellow-400 flex flex-col items-center text-center shadow-inner">
        <h1 className="text-3xl sm:text-4xl md:text-5xl font-extrabold tracking-tight text-neutral-900 max-w-3xl leading-tight">
          A MELHOR LOCADORA <br className="hidden sm:block" />
          PARA MOTORISTAS DE APLICATIVOS
        </h1>
        <p className="mt-5 max-w-2xl text-sm sm:text-base md:text-lg text-neutral-800 leading-relaxed">
          Aluguel de veículos com praticidade, conforto e segurança.
          A solução ideal para quem busca mobilidade sem burocracias.
        </p>
        <a
          href="#parceiros"
          className="mt-8 px-8 md:px-10 py-3.5 md:py-4 bg-neutral-900 text-white rounded-full shadow-xl hover:bg-neutral-800 transition-all text-base md:text-lg font-semibold"
        >
          ALUGUE CONOSCO
        </a>
      </section>
      {/* PRA QUEM É A Kars */}
      <section className="max-w-6xl mx-auto py-16 md:py-24 px-4 md:px-6">
        <h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-center mb-10 md:mb-16">
          PRA QUEM É A KARS
        </h2>
        <div className="grid sm:grid-cols-2 md:grid-cols-3 gap-6 md:gap-10">
          {/* CARD 1 */}
          <div className="p-8 md:p-10 bg-neutral-100 rounded-2xl shadow-md border text-center flex flex-col items-center gap-4">
            <p className="text-neutral-700 text-base md:text-lg">
              Deseja trabalhar com aplicativo de transporte de passageiros?
            </p>
          </div>
          {/* CARD 2 */}
          <div className="p-8 md:p-10 bg-neutral-100 rounded-2xl shadow-md border text-center flex flex-col items-center gap-4">
            <p className="text-neutral-700 text-base md:text-lg">
              Já é motorista e quer maximizar os seus ganhos?
            </p>
          </div>
          {/* CARD 3 */}
          <div className="p-8 md:p-10 bg-neutral-100 rounded-2xl shadow-md border text-center flex flex-col items-center gap-4">
            <p className="text-neutral-700 text-base md:text-lg">
              Sem cartão de crédito e sem burocracia.
            </p>
          </div>
        </div>
        <p className="text-center text-lg md:text-xl font-semibold mt-10">
          Então a Kars é pra você!
        </p>
        <p className="text-center text-neutral-600 mt-2 text-sm md:text-base">
          Não é necessário experiência prévia ou crédito para locar conosco.
        </p>
      </section>
      {/* COMO FUNCIONA */}
      <section id="como-funciona" className="py-16 md:py-24 bg-neutral-100 px-4 md:px-6">
        <h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-center mb-10 md:mb-16">
          Como funciona
        </h2>
        <div className="grid sm:grid-cols-1 md:grid-cols-3 gap-6 md:gap-10 max-w-6xl mx-auto">
          {[
            "Cadastre-se na Kars e aguarde nosso contato.",
            "Receba um carro.",
            "Trabalhe melhor e ganhe mais.",
          ].map((step, index) => (
            <div key={index} className="text-center p-8 bg-white rounded-2xl shadow-md border">
              <span className="text-3xl md:text-5xl font-bold text-yellow-500">{index + 1}</span>
              <p className="mt-4 text-neutral-700 text-base md:text-lg">{step}</p>
            </div>
          ))}
        </div>
        <div className="text-center mt-10 md:mt-14">
          <a
            href="#parceiros"
            className="px-8 md:px-10 py-3.5 md:py-4 bg-neutral-900 text-white rounded-full shadow-xl hover:bg-neutral-800 transition-all text-base md:text-lg font-semibold"
          >
            ALUGUE CONOSCO
          </a>
        </div>
      </section>
      {/* POR QUE A Kars */}
      <section id="por-que" className="py-16 md:py-24 px-4 md:px-6 bg-white">
        <h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-center mb-10 md:mb-16">
          Por que a Kars é a sua melhor escolha?
        </h2>
        <div className="max-w-5xl mx-auto">
          <div className="grid md:grid-cols-2 gap-6">
            <div className="bg-neutral-100 rounded-xl p-6 border shadow">
              <p className="text-neutral-800 font-semibold">Modelos sedan 1.0</p>
            </div>
            <div className="bg-neutral-100 rounded-xl p-6 border shadow">
              <p className="text-neutral-800 font-semibold">Manutenção preventiva sem custo</p>
            </div>
            <div className="bg-neutral-100 rounded-xl p-6 border shadow">
              <p className="text-neutral-800 font-semibold">Pagamento semanal</p>
            </div>
            <div className="bg-neutral-100 rounded-xl p-6 border shadow">
              <p className="text-neutral-800 font-semibold">Carros GNV</p>
            </div>
          </div>
        </div>
        <div className="text-center mt-10 md:mt-14">
          <a
            href="#parceiros"
            className="px-8 md:px-10 py-3.5 md:py-4 bg-yellow-500 text-black rounded-full shadow-xl hover:bg-yellow-600 transition-all text-base md:text-lg font-semibold"
          >
            ALUGUE CONOSCO
          </a>
        </div>
      </section>
      {/* FORM PARCEIROS */}
      <section id="parceiros" className="py-16 md:py-24 max-w-3xl mx-auto px-4 md:px-6">
        <h2 className="text-2xl sm:text-3xl md:text-4xl font-bold text-center mb-6 md:mb-10">
          FAÇA O SEU CADASTRO
        </h2>
        <p className="text-center text-neutral-600 mb-8 md:mb-10 text-sm md:text-base">
          Aproveite as vantagens de alugar com a Kars.
        </p>
        {ok ? (
          <div className="p-3 rounded-xl bg-green-100 text-green-700 text-sm text-center">
            Seu cadastro foi realizado com sucesso, fique de olho no seu e-mail e whatsapp para mais, detalhes. Acesse o link enviado para o seu e-mail e faça o login para acompanhar o status da sua locação.
          </div>
        ) : (
          <form
            onSubmit={submit}
            className="bg-white shadow-lg border border-neutral-200 rounded-2xl p-6 md:p-10 space-y-5 md:space-y-6"
          >
            <input
              placeholder="Nome Completo"
              className="w-full p-3.5 md:p-4 rounded-xl bg-neutral-100 border border-neutral-300"
              value={form.name}
              onChange={(e) => set("name", e.target.value)}
              required
            />
            <input
              placeholder="CPF ou CNPJ"
              className="w-full p-3.5 md:p-4 rounded-xl bg-neutral-100 border border-neutral-300"
              value={form.cpf}
              onChange={(e) => set("cpf", e.target.value)}
              required
            />
            <div className="space-y-2">
              <label className="font-semibold text-sm md:text-base">Data de nascimento</label>
              <input
                placeholder="Data de Nascimento"
                type="date"
                className="w-full p-3.5 md:p-4 rounded-xl bg-neutral-100 border border-neutral-300"
                value={form.birthdate}
                onChange={(e) => set("birthdate", e.target.value)}
              />
            </div>
            <input
              placeholder="WhatsApp ou Celular"
              className="w-full p-3.5 md:p-4 rounded-xl bg-neutral-100 border border-neutral-300"
              value={form.phone}
              onChange={(e) => set("phone", e.target.value)}
              required
            />
            <input
              type="email"
              placeholder="E-mail"
              className="w-full p-3.5 md:p-4 rounded-xl bg-neutral-100 border border-neutral-300"
              value={form.email}
              onChange={(e) => set("email", e.target.value)}
              required
            />
            <input
              placeholder="Cidade"
              className="w-full p-3.5 md:p-4 rounded-xl bg-neutral-100 border border-neutral-300"
              value={form.city}
              onChange={(e) => set("city", e.target.value)}
            />
            <div>
              <label className="font-semibold text-sm md:text-base">Possui EAR?</label>
              <select
                className="w-full mt-2 p-3.5 md:p-4 rounded-xl bg-neutral-100 border border-neutral-300"
                value={form.ear}
                onChange={(e) => set("ear", e.target.value)}
              >
                <option>Sim</option>
                <option>Não</option>
              </select>
            </div>
            <div>
              <label className="font-semibold text-sm md:text-base">Cadastrado na Uber?</label>
              <select
                className="w-full mt-2 p-3.5 md:p-4 rounded-xl bg-neutral-100 border border-neutral-300"
                value={form.uber}
                onChange={(e) => set("uber", e.target.value)}
              >
                <option>Sim</option>
                <option>Não</option>
              </select>
            </div>
            <button
              type="submit"
              disabled={loading}
              className="w-full bg-yellow-500 hover:bg-yellow-600 text-black font-semibold py-3.5 md:py-4 rounded-xl shadow-lg text-base md:text-lg transition disabled:opacity-70"
            >
              {loading ? "Enviando..." : "ENVIAR O SEU CADASTRO"}
            </button>
          </form>
        )}
        {/* O que é EAR */}
        <div className="mt-10 md:mt-16 p-6 md:p-8 bg-neutral-100 rounded-xl border shadow">
          <h3 className="text-xl md:text-2xl font-bold mb-3 md:mb-4">O que é EAR?</h3>
          <p className="text-neutral-700 leading-relaxed text-sm md:text-base">
            Para exercer atividade remunerada com o veículo, é preciso a inclusão da
            observação <strong>Exerce Atividade Remunerada (EAR)</strong> na sua CNH.
          </p>
        </div>
      </section>
      {showConfirm && !ok && (
        <div className="fixed inset-0 bg-black/60 z-[999] flex items-center justify-center px-4">
          <div className="bg-white w-full max-w-lg rounded-2xl shadow-2xl p-6 space-y-4">
            <h3 className="text-xl font-semibold text-neutral-900">Confirmar envio</h3>
            <p className="text-neutral-700 text-sm">
              Confira suas informações antes de enviar.
            </p>
            <div className="bg-neutral-50 border rounded-xl p-4 space-y-2 text-sm text-neutral-800">
              <p><strong>Nome:</strong> {form.name || "-"}</p>
              <p><strong>CPF/CNPJ:</strong> {form.cpf || "-"}</p>
              <p><strong>Nascimento:</strong> {form.birthdate || "-"}</p>
              <p><strong>Telefone:</strong> {form.phone || "-"}</p>
              <p><strong>E-mail:</strong> {form.email || "-"}</p>
              <p><strong>Cidade:</strong> {form.city || "-"}</p>
              <p><strong>EAR:</strong> {form.ear}</p>
              <p><strong>Uber:</strong> {form.uber}</p>
            </div>
            <div className="flex items-center justify-end gap-3">
              <button
                type="button"
                className="px-4 py-2 rounded-lg border text-neutral-700 hover:bg-neutral-100 transition"
                onClick={() => setShowConfirm(false)}
                disabled={loading}
              >
                Revisar
              </button>
              <button
                type="button"
                onClick={confirmSubmit}
                disabled={loading}
                className="px-4 py-2 rounded-lg bg-yellow-500 text-black font-semibold hover:bg-yellow-600 transition disabled:opacity-70"
              >
                {loading ? "Enviando..." : "Confirmar envio"}
              </button>
            </div>
          </div>
        </div>
      )}
      {/* WHATSAPP FLUTUANTE */}
      <a
        href="https://wa.me/5511000000000"
        target="_blank"
        rel="noopener noreferrer"
        className="
    fixed bottom-5 right-5 sm:bottom-6 sm:right-6
    bg-[#25D366] hover:bg-[#1ebe5d]
    text-white rounded-full cursor-pointer
    w-16 h-16 sm:w-20 sm:h-20
    flex items-center justify-center
    shadow-xl hover:shadow-2xl
    transition-all duration-300
    animate-pulse-soft
    z-50
  "
        aria-label="WhatsApp"
      >
        <svg xmlns="http://www.w3.org/2000/svg" fill="#ffffff" width="40" height="40" viewBox="0 0 32 32" version="1.1" >
<title>whatsapp</title>
<path d="M26.576 5.363c-2.69-2.69-6.406-4.354-10.511-4.354-8.209 0-14.865 6.655-14.865 14.865 0 2.732 0.737 5.291 2.022 7.491l-0.038-0.070-2.109 7.702 7.879-2.067c2.051 1.139 4.498 1.809 7.102 1.809h0.006c8.209-0.003 14.862-6.659 14.862-14.868 0-4.103-1.662-7.817-4.349-10.507l0 0zM16.062 28.228h-0.005c-0 0-0.001 0-0.001 0-2.319 0-4.489-0.64-6.342-1.753l0.056 0.031-0.451-0.267-4.675 1.227 1.247-4.559-0.294-0.467c-1.185-1.862-1.889-4.131-1.889-6.565 0-6.822 5.531-12.353 12.353-12.353s12.353 5.531 12.353 12.353c0 6.822-5.53 12.353-12.353 12.353h-0zM22.838 18.977c-0.371-0.186-2.197-1.083-2.537-1.208-0.341-0.124-0.589-0.185-0.837 0.187-0.246 0.371-0.958 1.207-1.175 1.455-0.216 0.249-0.434 0.279-0.805 0.094-1.15-0.466-2.138-1.087-2.997-1.852l0.010 0.009c-0.799-0.74-1.484-1.587-2.037-2.521l-0.028-0.052c-0.216-0.371-0.023-0.572 0.162-0.757 0.167-0.166 0.372-0.434 0.557-0.65 0.146-0.179 0.271-0.384 0.366-0.604l0.006-0.017c0.043-0.087 0.068-0.188 0.068-0.296 0-0.131-0.037-0.253-0.101-0.357l0.002 0.003c-0.094-0.186-0.836-2.014-1.145-2.758-0.302-0.724-0.609-0.625-0.836-0.637-0.216-0.010-0.464-0.012-0.712-0.012-0.395 0.010-0.746 0.188-0.988 0.463l-0.001 0.002c-0.802 0.761-1.3 1.834-1.3 3.023 0 0.026 0 0.053 0.001 0.079l-0-0.004c0.131 1.467 0.681 2.784 1.527 3.857l-0.012-0.015c1.604 2.379 3.742 4.282 6.251 5.564l0.094 0.043c0.548 0.248 1.25 0.513 1.968 0.74l0.149 0.041c0.442 0.14 0.951 0.221 1.479 0.221 0.303 0 0.601-0.027 0.889-0.078l-0.031 0.004c1.069-0.223 1.956-0.868 2.497-1.749l0.009-0.017c0.165-0.366 0.261-0.793 0.261-1.242 0-0.185-0.016-0.366-0.047-0.542l0.003 0.019c-0.092-0.155-0.34-0.247-0.712-0.434z"/>
</svg>
      </a>
      {/* FOOTER */}
      <footer className="bg-neutral-900 text-neutral-400 py-8 md:py-10 text-center mt-10 md:mt-20 px-4">
        <p className="text-sm md:text-base">
          Kars - Locação de Veículos
        </p>
        <p className="text-xs md:text-sm mt-1">
          Todos os direitos reservados.
        </p>
      </footer>
    </main>
  );
}
